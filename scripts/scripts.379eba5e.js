"use strict";angular.module("histoTennisApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","amChartsDirective","ngMaterial","ngMessages","ngAria","720kb.datepicker"]).config(["$routeProvider","$httpProvider",function(a,b){b.defaults.headers.common={},b.defaults.headers.post={},b.defaults.headers.put={},b.defaults.headers.get={},b.defaults.headers["delete"]={},b.defaults.headers.options={},a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/score",{templateUrl:"views/score.html",controller:"ScoreCtrl",controllerAs:"score"}).when("/histo",{templateUrl:"views/histo.html",controller:"HistoCtrl",controllerAs:"histo"}).otherwise({redirectTo:"/"})}]),angular.module("histoTennisApp").controller("MainCtrl",["$rootScope","$scope","$http","$q","$window","matchService",function(a,b,c,d,e,f){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.hasAccess=!1,b.checkAdmin=function(){"133133"===b.password&&e.localStorage.setItem("access","OK"),"OK"===e.localStorage.getItem("access")&&(a.hasAccess=!0),b.password=""},b.checkAdmin(),b.generateChartDataForPie=function(a,b){for(var c=[],d=0;d<a.length;d++)if(d===b&&a[d].subs.length>0)for(var e=0;e<a[d].subs.length;e++)c.push({type:a[d].subs[e].type,percent:a[d].subs[e].percent,color:a[d].color,percentToDisplay:a[d].subs[e].percentToDisplay,pulled:!0});else c.push({type:a[d].type,percent:a[d].percent,color:a[d].color,percentToDisplay:a[d].percentToDisplay,id:d});return c},b.generateChartOptionsForPie=function(a,c){var d,e={type:"pie",labelText:"[[title]]: [[description]]%",balloonText:"[[title]]: [[description]]%",titleField:"type",valueField:"percent",categoryField:"percentToDisplay",descriptionField:"percentToDisplay",outlineColor:"#FFFFFF",outlineAlpha:.7,outlineThickness:3,colorField:"color",pulledField:"pulled",titles:[{text:a}],listeners:[{event:"clickSlice",method:function(a){var e=a.chart;d=void 0!==a.dataItem.dataContext.id?a.dataItem.dataContext.id:void 0,c.then(function(a){e.dataProvider=b.generateChartDataForPie(a,d),e.validateData()})}}]};return c.then(function(a){return e.data=b.generateChartDataForPie(a,d),e})},b.amChartOptionsTotalVictories=b.generateChartOptionsForPie("Victoires totales",f.constructMatchesForTotalVictories()),b.amChartOptionsInOutVictories=b.generateChartOptionsForPie("Matches IN/OUT",f.constructMatchesForInOutVictories()),b.amChartOptionsSBVictories=b.generateChartOptionsForPie("Super TieBreak",f.constructMatchesForSBVictories()),b.amChartOptionsTBVictories=b.generateChartOptionsForPie("TieBreak",f.constructMatchesForTBVictories()),b.amChartOptionsAfterWonFirstSetVictories=b.generateChartOptionsForPie("Victoires fonction 1er set",f.constructMatchesForAfterWonFirstSetVictories()),f.constructDatasForTable().then(function(a){b.players=a})}]),angular.module("histoTennisApp").controller("ScoreCtrl",["$rootScope","$scope","$http","$q","$interval","$window","matchService",function(a,b,c,d,e,f,g){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.init=function(){b.player1Serving=!0,b.player1="",b.player2=""},b.getMatchesLive=function(){g.refreshMatchesLive().then(function(a){b.matchesLive=a,b.checkSetsFinished()})},b.saveMatchLive=function(){var a={};a.player1=b.player1,a.player2=b.player2,a.set1Player1=0,a.set1Player2=0,a.set2Player1=0,a.set2Player2=0,a.set3Player1=0,a.set3Player2=0,a.player1Serving=b.player1Serving,g.saveMatchLive(a).then(function(a){b.matchesLive=a,b.init()})},b.updateMatchLive=function(a){g.updateMatchLive(a).then(function(a){b.matchesLive=a,b.checkSetsFinished(),b.init()})},b.deleteMatchLive=function(a){g.deleteMatchLive(a).then(function(a){b.matchesLive=a,b.init()})},b.areNamesCorrect=function(){var a=!0;return(""===b.player1||""===b.player2)&&(a=!1),a},b.checkSetsFinished=function(){for(var a=0;a<b.matchesLive.length;a++){var c=parseInt(b.matchesLive[a].set1Player1),d=parseInt(b.matchesLive[a].set1Player2),e=parseInt(b.matchesLive[a].set2Player1),f=parseInt(b.matchesLive[a].set2Player2),g=parseInt(b.matchesLive[a].set3Player1),h=parseInt(b.matchesLive[a].set3Player2);6===c&&(5>d||7===d)||7===c&&(5===d||6===d)||6===d&&5>c||7===d&&5===c?b.matchesLive[a].set1Finished=!0:b.matchesLive[a].set1Finished=!1,b.matchesLive[0].set1Finished===!0&&(6===e&&(5>f||7===f)||7===e&&(5===f||6===f)||6===f&&5>e||7===f&&5===e)?b.matchesLive[a].set2Finished=!0:b.matchesLive[a].set2Finished=!1,b.matchesLive[0].set2Finished===!0&&(6===g&&(5>h||7===h)||7===g&&(5===h||6===f)||6===h&&5>g||7===h&&5===g)?b.matchesLive[a].set3Finished=!0:b.matchesLive[a].set3Finished=!1}},b.player1Plus=function(a){var c=parseInt(a.set1Player1),d=(parseInt(a.set1Player2),parseInt(a.set2Player1)),e=(parseInt(a.set2Player2),parseInt(a.set3Player1));parseInt(a.set3Player2);a.set1Finished===!0?a.set2Finished===!0?a.set3Player1=e+1:a.set2Player1=d+1:a.set1Player1=c+1,"0"===a.player1Serving?a.player1Serving=1:a.player1Serving=0,b.updateMatchLive(a)},b.player1Moins=function(a){var c=parseInt(a.set1Player1),d=(parseInt(a.set1Player2),parseInt(a.set2Player1)),e=(parseInt(a.set2Player2),parseInt(a.set3Player1));parseInt(a.set3Player2);a.set1Finished===!0?a.set2Finished===!0?0===e?a.set2Player1=d-1:a.set3Player1=e-1:0===d?a.set1Player1=c-1:a.set2Player1=d-1:c>0&&(a.set1Player1=c-1),"0"===a.player1Serving?a.player1Serving=1:a.player1Serving=0,b.updateMatchLive(a)},b.player2Plus=function(a){var c=(parseInt(a.set1Player1),parseInt(a.set1Player2)),d=(parseInt(a.set2Player1),parseInt(a.set2Player2)),e=(parseInt(a.set3Player1),parseInt(a.set3Player2));a.set1Finished===!0?a.set2Finished===!0?a.set3Player2=e+1:a.set2Player2=d+1:a.set1Player2=c+1,"0"===a.player1Serving?a.player1Serving=1:a.player1Serving=0,b.updateMatchLive(a)},b.player2Moins=function(a){var c=(parseInt(a.set1Player1),parseInt(a.set1Player2)),d=(parseInt(a.set2Player1),parseInt(a.set2Player2)),e=(parseInt(a.set3Player1),parseInt(a.set3Player2));a.set1Finished===!0?a.set2Finished===!0?0===e?a.set2Player2=d-1:a.set3Player2=e-1:0===d?a.set1Player2=c-1:a.set2Player2=d-1:c>0&&(a.set1Player2=c-1),"0"===a.player1Serving?a.player1Serving=1:a.player1Serving=0,b.updateMatchLive(a)},b.player1CanMoins=function(a){var b=!0,c=parseInt(a.set1Player1),d=parseInt(a.set2Player1),e=parseInt(a.set3Player1);return a.set1Finished===!1&&0>=c&&(b=!1),a.set2Finished===!1&&0>=d&&a.set1Finished===!1&&0>=c&&(b=!1),a.set3Finished===!1&&0>=e&&a.set2Finished===!1&&0>=d&&a.set1Finished===!1&&0>=c&&(b=!1),b},b.player2CanMoins=function(a){var b=!0,c=parseInt(a.set1Player2),d=parseInt(a.set2Player2),e=parseInt(a.set3Player2);return a.set1Finished===!1&&0>=c&&(b=!1),a.set2Finished===!1&&0>=d&&a.set1Finished===!1&&0>=c&&(b=!1),a.set3Finished===!1&&0>=e&&a.set2Finished===!1&&0>=d&&a.set1Finished===!1&&0>=c&&(b=!1),b},g.getMatchesLive().then(function(a){b.matchesLive=a,b.checkSetsFinished(),b.init()}),e(function(){b.getMatchesLive()},3e4)}]),angular.module("histoTennisApp").controller("HistoCtrl",["$rootScope","$scope","$http","$q","matchService",function(a,b,c,d,e){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],e.constructMatches().then(function(a){b.matches=a}),e.getPlayers().then(function(a){b.players=a}),b.init=function(){b.dateMatchToSave=new Date,b.set1TB=!1,b.set2TB=!1,b.set3TB=!1,b.is3sets=!1,b.scoreCorrect=!1,b.indoorMatch=!0,b.pointsSet1Player1="",b.pointsSet1Player2="",b.pointsSet2Player1="",b.pointsSet2Player2="",b.pointsSet3Player1="",b.pointsSet3Player2="",b.pointsSet1Player1TB="",b.pointsSet1Player2TB="",b.pointsSet2Player1TB="",b.pointsSet2Player2TB="",b.pointsSet3Player1TB="",b.pointsSet3Player2TB="";var a=new Date,c=a.toISOString().substring(0,10);b.matchToSave={dateMatch:c},console.log(b.matchToSave.dateMatch)},b.checkScore=function(){var a=b.checkSet(1,b.pointsSet1Player1,b.pointsSet1Player2),c=b.checkSet(2,b.pointsSet2Player1,b.pointsSet2Player2),d=!1;a===!0&&c===!0?(b.isA3Set(b.pointsSet1Player1,b.pointsSet1Player2,b.pointsSet2Player1,b.pointsSet2Player2),b.is3sets===!0?d=b.checkSet3(b.pointsSet3Player1,b.pointsSet3Player2):(b.pointsSet3Player1TB="",b.pointsSet3Player2TB="",b.pointsSet3Player1="",b.pointsSet3Player2="",d=!0)):(b.is3sets=!1,b.pointsSet3Player1TB="",b.pointsSet3Player2TB="",b.pointsSet3Player1="",b.pointsSet3Player2=""),b.scoreCorrect=d},b.checkSet=function(a,c,d){var e=!1;if(1===a&&(b.set1TB=!1),2===a&&(b.set2TB=!1),""!==c&&""!==d&&isNaN(c)===!1&&isNaN(d)===!1){var f=parseInt(c),g=parseInt(d);if(6===f&&(5>g||7===g)||7===f&&5===g)if(7===g&&6===f){if(1===a){b.set1TB=!0;var h=b.checkSetTB(c,d,b.pointsSet1Player1TB,b.pointsSet1Player2TB);h&&(e=!0)}if(2===a){b.set2TB=!0;var h=b.checkSetTB(c,d,b.pointsSet2Player1TB,b.pointsSet2Player2TB);h&&(e=!0)}}else e=!0;if(6===g&&(5>f||7===f)||7===g&&5===f)if(7===f&&6===g){if(1===a){b.set1TB=!0;var h=b.checkSetTB(c,d,b.pointsSet1Player1TB,b.pointsSet1Player2TB);h&&(e=!0)}if(2===a){b.set2TB=!0;var h=b.checkSetTB(c,d,b.pointsSet2Player1TB,b.pointsSet2Player2TB);h&&(e=!0)}}else e=!0}return e},b.checkSet3=function(a,c){var d=!1;if(b.set3TB=!1,""!==a&&""!==c&&isNaN(a)===!1&&isNaN(c)===!1){var e=parseInt(a),f=parseInt(c);if(6===e&&(5>f||7===f)||7===e&&5===f)if(7===f&&6===e){b.set3TB=!0;var g=b.checkSetTB(a,c,b.pointsSet3Player1TB,b.pointsSet3Player2TB);g&&(d=!0)}else d=!0;if(6===f&&(5>e||7===e)||7===f&&5===e)if(7===e&&6===f){b.set3TB=!0;var g=b.checkSetTB(a,c,b.pointsSet3Player1TB,b.pointsSet3Player2TB);g&&(d=!0)}else d=!0;10===e&&8>=f&&(d=!0),10===f&&8>=e&&(d=!0),e>10&&f===e-2&&(d=!0),f>10&&e===f-2&&(d=!0)}return d},b.checkSetTB=function(a,b,c,d){var e=!1;if(""!==c&&""!==d&&isNaN(c)===!1&&isNaN(d)===!1){var f=parseInt(c),g=parseInt(d);parseInt(a),parseInt(b);7===f&&5>=g&&a>b&&(e=!0),7===g&&5>=f&&b>a&&(e=!0),g>7&&f===g-2&&b>a&&(e=!0),f>7&&g===f-2&&a>b&&(e=!0)}return e},b.isA3Set=function(a,c,d,e){b.is3sets=!1,a>c&&e>d&&(b.is3sets=!0),c>a&&d>e&&(b.is3sets=!0)},b.constructMatchToSave=function(a,c,d,e,f,g,h,i,j,k,l,m){b.indoorMatch?b.matchToSave.indoorMatch=1:b.matchToSave.indoorMatch=0,a>c?d>e?(b.matchToSave.idWinner=1,b.matchToSave.idLoser=2):f>g?(b.matchToSave.idWinner=1,b.matchToSave.idLoser=2):(b.matchToSave.idWinner=2,b.matchToSave.idLoser=1):e>d?(b.matchToSave.idWinner=2,b.matchToSave.idLoser=1):f>g?(b.matchToSave.idWinner=1,b.matchToSave.idLoser=2):(b.matchToSave.idWinner=2,b.matchToSave.idLoser=1);var n=null,o=null,p=null;if(7===a&&6===c&&(n=i),6===a&&7===c&&(n=h),7===d&&6===e&&(o=k),6===d&&7===e&&(o=j),null!==f&&(7===f&&6===g&&(p=m),6===f&&7===g&&(p=l)),1===b.matchToSave.idWinner&&(b.matchToSave.sets=[{winnerGames:b.pointsSet1Player1,loserGames:b.pointsSet1Player2,superTieBreak:0,tiebreakLoserPoints:n},{winnerGames:b.pointsSet2Player1,loserGames:b.pointsSet2Player2,superTieBreak:0,tiebreakLoserPoints:o}],null!==f)){var q=0;(f>9||g>9)&&(q=1),b.matchToSave.sets[2]={winnerGames:b.pointsSet3Player1,loserGames:b.pointsSet3Player2,superTieBreak:q,tiebreakLoserPoints:p}}if(2===b.matchToSave.idWinner&&(b.matchToSave.sets=[{winnerGames:b.pointsSet1Player2,loserGames:b.pointsSet1Player1,superTieBreak:0,tiebreakLoserPoints:n},{winnerGames:b.pointsSet2Player2,loserGames:b.pointsSet2Player1,superTieBreak:0,tiebreakLoserPoints:o}],null!==f)){var q=0;(f>9||g>9)&&(q=1),b.matchToSave.sets[2]={winnerGames:b.pointsSet3Player2,loserGames:b.pointsSet3Player1,superTieBreak:q,tiebreakLoserPoints:p}}},b.save=function(){var a=null,c=null,d=null,f=null,g=null,h=null,i=null,j=null,k=parseInt(b.pointsSet1Player1),l=parseInt(b.pointsSet1Player2),m=parseInt(b.pointsSet2Player1),n=parseInt(b.pointsSet2Player2);""!==b.pointsSet1Player1TB&&isNaN(b.pointsSet1Player1TB)===!1&&(g=parseInt(b.pointsSet1Player1TB)),""!==b.pointsSet1Player2TB&&isNaN(b.pointsSet1Player2TB)===!1&&(h=parseInt(b.pointsSet1Player2TB)),""!==b.pointsSet2Player1TB&&isNaN(b.pointsSet2Player1TB)===!1&&(i=parseInt(b.pointsSet2Player1TB)),""!==b.pointsSet2Player2TB&&isNaN(b.pointsSet2Player2TB)===!1&&(j=parseInt(b.pointsSet2Player2TB)),""!==b.pointsSet3Player1&&isNaN(b.pointsSet3Player1)===!1&&(a=parseInt(b.pointsSet3Player1)),""!==b.pointsSet3Player2&&isNaN(b.pointsSet3Player2)===!1&&(c=parseInt(b.pointsSet3Player2)),""!==b.pointsSet3Player1TB&&isNaN(b.pointsSet3Player1TB)===!1&&(d=parseInt(b.pointsSet3Player1TB)),""!==b.pointsSet3Player2TB&&isNaN(b.pointsSet3Player2TB)===!1&&(f=parseInt(b.pointsSet3Player2TB)),b.constructMatchToSave(k,l,m,n,a,c,g,h,i,j,d,f),e.saveMatch(b.matchToSave).then(function(a){b.matches=a,b.init()})},b.init()}]),angular.module("histoTennisApp").service("remoteService",["$http",function(a){var b="http://localhost:8888/histoTennisBack/api";this.get=function(c){return a.get(b+c)},this.post=function(c,d){return a.post(b+c,d)},this["delete"]=function(c){return a["delete"](b+c)}}]),angular.module("histoTennisApp").service("matchService",["$q","remoteService","statsService",function(a,b,c){var d={matches:b.get("/matches"),players:b.get("/players"),matchesLive:b.get("/matchesLive")},e=["#FE6600","#222"],f={"01":"Jan","02":"Fev","03":"Mar","04":"Avr","05":"Mai","06":"Juin","07":"Juil","08":"Aoû","09":"Sep",10:"Oct",11:"Nov",12:"Dec"};this.constructMatchesForTotalVictories=function(){return a.all(d).then(function(b){for(var d=b.matches.data,f=b.players.data,g=c.generateVictoriesPercentage(d,f[0],f[1]),h=[],i=0;i<g.length;i++){var j={};j.type=f[i].firstName+" "+f[i].lastName,j.percent=g[i].victories,j.percentToDisplay=g[i].victories,j.color=e[i],j.subs=[];var k={type:"2 sets",percent:g[i].victories2Sets.real,percentToDisplay:g[i].victories2Sets.displayed,color:e[i]},l={type:"3 sets",percent:g[i].victories3Sets.real,percentToDisplay:g[i].victories3Sets.displayed,color:e[i]};j.subs.push(k),j.subs.push(l),h.push(j)}return a.when(h)})},this.constructMatchesForInOutVictories=function(){return a.all(d).then(function(b){for(var d=b.matches.data,f=b.players.data,g=c.generateInOutPercentageWithVictories(d,f[0],f[1]),h=[],i=0;i<g.length;i++){var j={};j.type=g[i].type,j.percent=g[i].percent,j.percentToDisplay=g[i].percent,j.color=e[i],j.subs=[];var k={type:f[0].firstName+" "+f[0].lastName,percent:g[i].statsPlayer[0].percent,percentToDisplay:g[i].statsPlayer[0].percentToDisplay,color:e[i]},l={type:f[1].firstName+" "+f[1].lastName,percent:g[i].statsPlayer[1].percent,percentToDisplay:g[i].statsPlayer[1].percentToDisplay,color:e[i]};j.subs.push(k),j.subs.push(l),h.push(j)}return a.when(h)})},this.constructMatchesForSBVictories=function(){return a.all(d).then(function(b){for(var d=b.matches.data,f=b.players.data,g=c.generateSuperTieBreakPercentage(d,f[0],f[1]),h=[],i=0;i<g.length;i++){var j={};j.type=g[i].type,j.percent=g[i].percent,j.percentToDisplay=g[i].percent,j.color=e[i],j.subs=[];var k={type:f[0].firstName+" "+f[0].lastName,percent:g[i].statsPlayer[0].percent,percentToDisplay:g[i].statsPlayer[0].percentToDisplay,color:e[i]},l={type:f[1].firstName+" "+f[1].lastName,percent:g[i].statsPlayer[1].percent,percentToDisplay:g[i].statsPlayer[1].percentToDisplay,color:e[i]};j.subs.push(k),j.subs.push(l),h.push(j)}return a.when(h)})},this.constructMatchesForTBVictories=function(){return a.all(d).then(function(b){for(var d=b.matches.data,f=b.players.data,g=c.generateTieBreakPercentage(d,f[0],f[1]),h=[],i=0;i<g.length;i++){var j={};j.type=g[i].type,j.percent=g[i].percent,j.percentToDisplay=g[i].percentToDisplay,j.color=e[i],j.subs=[];var k={type:f[0].firstName+" "+f[0].lastName,percent:g[i].statsPlayer[0].percent,percentToDisplay:g[i].statsPlayer[0].percentToDisplay,color:e[i]},l={type:f[1].firstName+" "+f[1].lastName,percent:g[i].statsPlayer[1].percent,percentToDisplay:g[i].statsPlayer[1].percentToDisplay,color:e[i]};j.subs.push(k),j.subs.push(l),h.push(j)}return a.when(h)})},this.constructMatchesForAfterWonFirstSetVictories=function(){return a.all(d).then(function(b){for(var d=b.matches.data,f=b.players.data,g=c.generateAfterWonFirstSetPercentage(d,f[0],f[1]),h=[],i=0;i<g.length;i++){var j={};j.type=g[i].type,j.percent=g[i].percent,j.percentToDisplay=g[i].percentToDisplay,j.color=e[i],j.subs=[];var k={type:f[0].firstName+" "+f[0].lastName,percent:g[i].statsPlayer[0].percent,percentToDisplay:g[i].statsPlayer[0].percentToDisplay,color:e[i]},l={type:f[1].firstName+" "+f[1].lastName,percent:g[i].statsPlayer[1].percent,percentToDisplay:g[i].statsPlayer[1].percentToDisplay,color:e[i]};j.subs.push(k),j.subs.push(l),h.push(j)}return a.when(h)})},this.constructDatasForTable=function(){return a.all(d).then(function(a){for(var b=a.matches.data,d=a.players.data,e=0;e<d.length;e++)d[e].victories=c.countVictoriesForPlayer(b,d[e]),d[e].straightVictories=c.countStraightVictoriesForPlayer(b,d[e]),d[e].setsPerMatches=c.countSetsPerMatchesForPlayer(b,d[e]),d[e].gamesPerSets=c.countGamesPerSetForPlayer(b,d[e]),d[e].tbWon=c.countTBWon(b,d[e]),d[e].pointsPerTB=c.countPointsPerTBForPlayer(b,d[e]),d[e].stbWon=c.countSTBWon(b,d[e]),d[e].pointsPerSTB=c.countPointsPerSTBForPlayer(b,d[e]);return d})},this.constructMatches=function(){return a.all(d).then(function(a){for(var b=a.matches.data,c=0;c<b.length;c++){var d=b[c].dateMatch.split("-");b[c].dateMatchYear=d[0],b[c].dateMatchMonth=f[d[1]],b[c].dateMatchDay=d[2];for(var e=0;e<b[c].sets.length;e++)if(b[c].sets[e].tiebreakLoserPoints){var g=Number(b[c].sets[e].tiebreakLoserPoints);6>g?b[c].sets[e].tiebreakWinnerPoints=7:b[c].sets[e].tiebreakWinnerPoints=g+2}}return b})},this.getPlayers=function(){return a.all(d).then(function(a){var b=a.players.data;return b})},this.saveMatch=function(a){return b.post("/match/new",a).then(function(a){return b.get("/matches").then(function(a){for(var b=a.data,c=0;c<b.length;c++){var d=b[c].dateMatch.split("-");b[c].dateMatchYear=d[0],b[c].dateMatchMonth=f[d[1]],b[c].dateMatchDay=d[2];for(var e=0;e<b[c].sets.length;e++)if(b[c].sets[e].tiebreakLoserPoints){var g=Number(b[c].sets[e].tiebreakLoserPoints);6>g?b[c].sets[e].tiebreakWinnerPoints=7:b[c].sets[e].tiebreakWinnerPoints=g+2}}return b})})},this.saveMatchLive=function(a){return b.post("/matchLive/new",a).then(function(a){return b.get("/matchesLive").then(function(a){var b=a.data;return b})})},this.updateMatchLive=function(a){return b.post("/matchLive/update",a).then(function(a){return b.get("/matchesLive").then(function(a){var b=a.data;return b})})},this.deleteMatchLive=function(a){return b.post("/delete/matchLive/"+a,null).then(function(a){return b.get("/matchesLive").then(function(a){var b=a.data;return b})})},this.refreshMatchesLive=function(){return b.get("/matchesLive").then(function(a){var b=a.data;return b})},this.getMatchesLive=function(){return a.all(d).then(function(a){var b=a.matchesLive.data;return b})}}]),angular.module("histoTennisApp").service("statsService",function(){this.generateVictoriesPercentage=function(a,b,c){for(var d=[],e={id:b.idPlayer},f={id:c.idPlayer},g=0,h=0,i=0,j=0,k=0,l=0;l<a.length;l++){var m=a[l];m.idWinner===b.idPlayer?(g++,k++,2===m.sets.length&&i++):m.idWinner===c.idPlayer&&(h++,k++,2===m.sets.length&&j++)}var n=this.roundTo2decimals(100*g/(g+h));e.victories=n,e.victories2Sets={},e.victories3Sets={},f.victories2Sets={},f.victories3Sets={};var o=this.roundTo2decimals(100*i/(g+h));e.victories2Sets.real=o,e.victories2Sets.displayed=this.roundTo2decimals(100*i/g),e.victories3Sets.real=this.roundTo2decimals(n-o),e.victories3Sets.displayed=this.roundTo2decimals(100-e.victories2Sets.displayed);var p=this.roundTo2decimals(100*h/(g+h));f.victories=p;var q=this.roundTo2decimals(100*j/(h+g));return f.victories2Sets.real=q,f.victories2Sets.displayed=this.roundTo2decimals(100*j/h),f.victories3Sets.real=this.roundTo2decimals(p-q),f.victories3Sets.displayed=this.roundTo2decimals(100-f.victories2Sets.displayed),d.push(e),d.push(f),d},this.generateInOutPercentageWithVictories=function(a,b,c){for(var d=[],e={},f={},g=0,h=0,i=0,j=0,k=0,l=0;l<a.length;l++){var m=a[l];"1"===m.indoorMatch?(g++,m.idWinner===b.idPlayer?h++:m.idWinner===c.idPlayer&&i++):m.idWinner===b.idPlayer?j++:m.idWinner===c.idPlayer&&k++}e.type="Matches IN",e.percent=this.roundTo2decimals(100*g/a.length),e.percentToDisplay=this.roundTo2decimals(100*g/a.length);var n=[],o={name:b.firstName+" "+b.lastName,percent:this.roundTo2decimals(100*h/a.length),percentToDisplay:this.roundTo2decimals(100*h/g)},p={name:c.firstName+" "+c.lastName,percent:this.roundTo2decimals(100*i/a.length),percentToDisplay:this.roundTo2decimals(100*i/g)};n.push(o),n.push(p),e.statsPlayer=n,f.type="Matches OUT",f.percent=this.roundTo2decimals(100-100*g/a.length),e.percentToDisplay=this.roundTo2decimals(100-100*g/a.length);var q=[],r={name:b.firstName+" "+b.lastName,percent:this.roundTo2decimals(100*j/a.length),percentToDisplay:this.roundTo2decimals(100*j/(a.length-g))},s={name:c.firstName+" "+c.lastName,percent:this.roundTo2decimals(100*k/a.length),percentToDisplay:this.roundTo2decimals(100*k/(a.length-g))};return q.push(r),q.push(s),f.statsPlayer=q,d.push(e),d.push(f),d},this.generateSuperTieBreakPercentage=function(a,b,c){for(var d=[],e={},f={},g=0,h=0,i=0,j=0,k=0,l=0;l<a.length;l++){for(var m=!1,n=0;n<a[l].sets.length;n++)"1"===a[l].sets[n].superTieBreak&&(g++,m=!0,a[l].idWinner===b.idPlayer?h++:a[l].idWinner===c.idPlayer&&i++);m||(a[l].idWinner===b.idPlayer?j++:a[l].idWinner===c.idPlayer&&k++)}e.type="Matches avec STB",e.percent=this.roundTo2decimals(100*g/a.length),e.percentToDisplay=this.roundTo2decimals(100*g/a.length);var o={};o.percent=this.roundTo2decimals(100*h/a.length),o.percentToDisplay=this.roundTo2decimals(100*h/g);var p={};p.percent=this.roundTo2decimals(100*i/a.length),p.percentToDisplay=this.roundTo2decimals(100*i/g);var q=[];q.push(o),q.push(p),e.statsPlayer=q,f.type="Matches sans STB",f.percent=this.roundTo2decimals(100-100*g/a.length),f.percent=this.roundTo2decimals(100-100*g/a.length);var r={};r.percent=this.roundTo2decimals(100*j/a.length),r.percentToDisplay=this.roundTo2decimals(100*j/(a.length-g));var s={};s.percent=this.roundTo2decimals(100*k/a.length),s.percentToDisplay=this.roundTo2decimals(100*k/(a.length-g));var t=[];return t.push(r),t.push(s),f.statsPlayer=t,d.push(e),d.push(f),d},this.generateTieBreakPercentage=function(a,b,c){for(var d=[],e={},f={},g=0,h=0,i=0,j=0,k=0,l=0,m=0;m<a.length;m++)for(var n=0;n<a[m].sets.length;n++)g++,a[m].sets[n].tiebreakLoserPoints?(h++,a[m].idWinner===b.idPlayer?"7"===a[m].sets[n].winnerGames?i++:j++:a[m].idWinner===c.idPlayer&&("7"===a[m].sets[n].winnerGames?j++:i++)):a[m].idWinner===b.idPlayer?parseInt(a[m].sets[n].winnerGames)>parseInt(a[m].sets[n].loserGames)?k++:l++:parseInt(a[m].sets[n].winnerGames)>parseInt(a[m].sets[n].loserGames)?l++:k++;e.type="Sets avec TB",e.percent=this.roundTo2decimals(100*h/g),e.percentToDisplay=this.roundTo2decimals(100*h/g);var o={};o.percent=this.roundTo2decimals(100*i/g),o.percentToDisplay=this.roundTo2decimals(100*i/h);var p={};p.percent=this.roundTo2decimals(100*j/g),p.percentToDisplay=this.roundTo2decimals(100*j/h);var q=[];q.push(o),q.push(p),e.statsPlayer=q,f.type="Sets sans TB",f.percent=this.roundTo2decimals(100*(g-h)/g),f.percentToDisplay=this.roundTo2decimals(100*(g-h)/g);var r={};r.percent=this.roundTo2decimals(100*k/g),r.percentToDisplay=this.roundTo2decimals(100*k/(g-h));var s={};s.percent=this.roundTo2decimals(100*l/g),s.percentToDisplay=this.roundTo2decimals(100*l/(g-h));var t=[];return t.push(r),t.push(s),f.statsPlayer=t,d.push(e),d.push(f),d},this.generateAfterWonFirstSetPercentage=function(a,b,c){for(var d=[],e={},f={},g=a.length,h=0,i=0,j=0,k=0,l=0;l<a.length;l++)2===a[l].sets.length?(a[l].idWinner===b.idPlayer&&h++,a[l].idWinner===c.idPlayer&&i++):(a[l].idWinner===b.idPlayer&&(a[l].sets[0].winnerGames<a[l].sets[0].loserGames?j++:h++),a[l].idWinner===c.idPlayer&&(a[l].sets[0].winnerGames<a[l].sets[0].loserGames?k++:i++));e.type="Gain 1er set",e.percent=this.roundTo2decimals(100*(h+i)/g),e.percentToDisplay=this.roundTo2decimals(100*(h+i)/g);var m={};m.percent=this.roundTo2decimals(100*h/g),m.percentToDisplay=this.roundTo2decimals(100*h/(h+i));var n={};n.percent=this.roundTo2decimals(100*i/g),n.percentToDisplay=this.roundTo2decimals(100*i/(h+i));var o=[];o.push(m),o.push(n),e.statsPlayer=o,f.type="Défaite 1er set",f.percent=this.roundTo2decimals(100*(j+k)/g),f.percentToDisplay=this.roundTo2decimals(100*(j+k)/g);var p={};p.percent=this.roundTo2decimals(100*j/g),p.percentToDisplay=this.roundTo2decimals(100*j/(j+k));var q={};q.percent=this.roundTo2decimals(100*k/g),q.percentToDisplay=this.roundTo2decimals(100*k/(j+k));var r=[];return r.push(p),r.push(q),f.statsPlayer=r,d.push(e),d.push(f),d},this.countVictoriesForPlayer=function(a,b){for(var c=0,d=0;d<a.length;d++)a[d].idWinner===b.idPlayer&&c++;return c},this.countStraightVictoriesForPlayer=function(a,b){for(var c=0,d=0,e=0;e<a.length;e++)a[e].idWinner===b.idPlayer?(d++,d>c&&(c=d)):d=0;return c},this.countSetsPerMatchesForPlayer=function(a,b){for(var c=0,d=0;d<a.length;d++)for(var e=0;e<a[d].sets.length;e++)a[d].idWinner===b.idPlayer?parseInt(a[d].sets[e].winnerGames)>parseInt(a[d].sets[e].loserGames)&&c++:parseInt(a[d].sets[e].winnerGames)<parseInt(a[d].sets[e].loserGames)&&c++;return this.roundTo2decimals(c/a.length)},this.countGamesPerSetForPlayer=function(a,b){for(var c=0,d=0,e=0;e<a.length;e++)for(var f=0;f<a[e].sets.length;f++)d++,c=a[e].idWinner===b.idPlayer?this.addUpStrings(c,a[e].sets[f].winnerGames):this.addUpStrings(c,a[e].sets[f].loserGames);return this.roundTo2decimals(c/d)},this.countPointsPerTBForPlayer=function(a,b){for(var c=0,d=0,e=0;e<a.length;e++)for(var f=0;f<a[e].sets.length;f++)if(null!==a[e].sets[f].tiebreakLoserPoints){var g=parseInt(a[e].sets[f].tiebreakLoserPoints);d++,c+=a[e].idWinner===b.idPlayer?parseInt(a[e].sets[f].winnerGames)>parseInt(a[e].sets[f].loserGames)?5>=g?7:g+2:g:parseInt(a[e].sets[f].winnerGames)<parseInt(a[e].sets[f].loserGames)?5>=g?7:g+2:g}return this.roundTo2decimals(c/d)},this.countPointsPerSTBForPlayer=function(a,b){for(var c=0,d=0,e=0;e<a.length;e++)for(var f=0;f<a[e].sets.length;f++)if("1"===a[e].sets[f].superTieBreak){var g=parseInt(a[e].sets[f].loserGames),h=parseInt(a[e].sets[f].winnerGames);d++,c+=a[e].idWinner===b.idPlayer?h:g}return this.roundTo2decimals(c/d)},this.countTBWon=function(a,b){for(var c=0,d=0;d<a.length;d++)for(var e=0;e<a[d].sets.length;e++)null!==a[d].sets[e].tiebreakLoserPoints&&(a[d].idWinner===b.idPlayer?parseInt(a[d].sets[e].winnerGames)>parseInt(a[d].sets[e].loserGames)&&c++:parseInt(a[d].sets[e].winnerGames)<parseInt(a[d].sets[e].loserGames)&&c++);return c},this.countSTBWon=function(a,b){for(var c=0,d=0;d<a.length;d++)for(var e=0;e<a[d].sets.length;e++)"1"===a[d].sets[e].superTieBreak&&(a[d].idWinner===b.idPlayer?parseInt(a[d].sets[e].winnerGames)>parseInt(a[d].sets[e].loserGames)&&c++:parseInt(a[d].sets[e].winnerGames)<parseInt(a[d].sets[e].loserGames)&&c++);return c},this.roundTo2decimals=function(a){return+(Math.round(a+"e+2")+"e-2")},this.addUpStrings=function(a,b){var c=parseInt(a),d=parseInt(b);return c+d}}),angular.module("histoTennisApp").run(["$templateCache",function(a){a.put("views/histo.html",'<div class="histo-view"> <div ng-show="hasAccess" class="match-container-save"> <div class="match toSave match-font"> <div class="typeToSave"> <md-switch ng-model="indoorMatch"> </md-switch> </div> <div class="date"> <datepicker date-format="yyyy-MM-dd"> <input ng-change="debug()" class="date-picker" ng-model="matchToSave.dateMatch" type="text"> </datepicker> </div> <div class="player"> <div class="name">{{players[0].firstName}}</div> <div class="name">{{players[1].firstName}}</div> </div> <div class="scores"> <div class="set"> <div class="points"> <input ng-model="pointsSet1Player1" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set1TB" ng-model="pointsSet1Player1TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> <div class="points"> <input ng-model="pointsSet1Player2" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set1TB" ng-model="pointsSet1Player2TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> </div> <div class="set"> <div class="points"> <input ng-model="pointsSet2Player1" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set2TB" ng-model="pointsSet2Player1TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> <div class="points"> <input ng-model="pointsSet2Player2" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set2TB" ng-model="pointsSet2Player2TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> </div> <div ng-show="is3sets" class="set"> <div class="points"> <input ng-model="pointsSet3Player1" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set3TB" ng-model="pointsSet3Player1TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> <div class="points"> <input ng-model="pointsSet3Player2" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> <input ng-show="set3TB" ng-model="pointsSet3Player2TB" ng-change="checkScore()" class="set-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> </div> </div> <div ng-show="scoreCorrect" class="button-save"> <button ng-click="save()" type="button" class="btn btn-default btn-save"><span class="glyphicon glyphicon-floppy-disk"></span></button> </div> <div class="separator"></div> </div> </div> <div ng-repeat="match in matches" class="match-container"> <div class="match match-font"> <div ng-class="{matchIn: match.indoorMatch == \'1\', matchOut: match.indoorMatch == \'0\'}" class="type"> </div> <div class="date"> <div class="HopeDate"> <div class="headerDate"> <div class="day">{{match.dateMatchDay}}</div> </div> <div class="body"> <div class="month">{{match.dateMatchMonth}} {{match.dateMatchYear}}</div> </div> </div> </div> <div class="player"> <div class="name">{{match.winner.firstName}} <span class="match-winner glyphicon glyphicon-ok"></span></div> <div class="name">{{match.loser.firstName}}</div> </div> <div class="scores"> <div ng-repeat="set in match.sets" ng-class="{set: set.winnerGames > 0, withTieBreak: set.tiebreakLoserPoints}"> <div ng-class="{points: set.winnerGames > 0, win: (set.winnerGames > set.loserGames && set.superTieBreak == \'0\') || set.superTieBreak == \'1\' }">{{set.winnerGames}} <div ng-if="set.winnerGames < 7">{{set.tiebreakLoserPoints}}</div> <div ng-if="set.winnerGames > 6">{{set.tiebreakWinnerPoints}}</div> </div> <div ng-class="{points: set.winnerGames > 0, win: (set.winnerGames < set.loserGames && set.superTieBreak == \'0\')}">{{set.loserGames}} <div ng-if="set.loserGames < 7">{{set.tiebreakLoserPoints}}</div> <div ng-if="set.loserGames > 6">{{set.tiebreakWinnerPoints}}</div> </div> </div> </div> <div class="separator"></div> </div> </div> </div>'),a.put("views/main.html",'<div> <div class="col-xs-6 col-md-6" style="height: 500px"> <am-chart id="totalVictories" class="chartElement" options="amChartOptionsTotalVictories"></am-chart> </div> <div class="col-xs-6 col-md-6" style="height: 500px"> <am-chart id="inOutVictories" class="chartElement" options="amChartOptionsInOutVictories"></am-chart> </div> </div> <div> <div class="col-xs-6 col-md-6" style="height: 500px"> <am-chart id="superTieBreakVictories" class="chartElement" options="amChartOptionsSBVictories"></am-chart> </div> <div class="col-xs-6 col-md-6" style="height: 500px"> <am-chart id="tieBreakVictories" class="chartElement" options="amChartOptionsTBVictories"></am-chart> </div> </div> <div> <div class="col-xs-3 col-md-3" style="height: 500px"> </div> <div class="col-xs-6 col-md-6" style="height: 500px"> <am-chart id="afterWonFirstSetVictories" class="chartElement" options="amChartOptionsAfterWonFirstSetVictories"></am-chart> </div> <div class="col-xs-3 col-md-3" style="height: 500px"> </div> </div> <div class="col-xs-12 col-md-12"> <table class="table"> <thead class="thead-inverse"> <tr> <th>Joueur</th> <th>Victoires</th> <th>Série de victoires</th> <th>Sets/Match</th> <th>Jeux/Sets</th> <th>TB gagnés</th> <th>Points/TB</th> <th>STB gagnés</th> <th>Points/STB</th> </tr> </thead> <tbody> <tr ng-repeat="p in players"> <th scope="row">{{p.firstName}} {{p.lastName}}</th> <td>{{p.victories}}</td> <td>{{p.straightVictories}}</td> <td>{{p.setsPerMatches}}</td> <td>{{p.gamesPerSets}}</td> <td>{{p.tbWon}}</td> <td>{{p.pointsPerTB}}</td> <td>{{p.stbWon}}</td> <td>{{p.pointsPerSTB}}</td> </tr> </tbody> </table> </div>'),
a.put("views/score.html",'<div class="histo-view"> <div ng-show="hasAccess" class="match-container-save"> <div class="match toSave match-font"> <div class="player"> <div class="name"> <div class="input-group"> <input ng-model="player1Serving" ng-value="true" type="radio" name="isPlayer1Serving"> <input ng-model="player1" class="player-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> </div> <div class="name"> <div class="input-group"> <input ng-model="player1Serving" ng-value="false" type="radio" name="isPlayer1Serving"> <input ng-model="player2" class="player-to-save" type="text" class="form-control" aria-describerby="basic-addon2"> </div> </div> </div> <div ng-show="areNamesCorrect()" class="button-save"> <button ng-click="saveMatchLive()" type="button" class="btn btn-default btn-save"><span class="glyphicon glyphicon-floppy-disk"></span></button> </div> <div class="separator"></div> </div> </div> <div ng-repeat="match in matchesLive" class="match-container"> <div class="match match-font"> <div class="player"> <div ng-show="match.player1Serving == 1" id="serve" class="servePlayer1"></div> <div class="name">{{match.player1}}</div> <div class="score-player1 btn-group" role="group" aria-label=""> <button ng-click="player1Plus(match)" type="button" class="btn btn-default">+</button> <button ng-show="player1CanMoins(match)" ng-click="player1Moins(match)" type="button" class="score-moins btn btn-default">-</button> </div> <div ng-show="match.player1Serving == 0" id="serve" class="servePlayer2"></div> <div class="name">{{match.player2}}</div> <div class="score-player2 btn-group" role="group" aria-label=""> <button ng-click="player2Plus(match)" type="button" class="btn btn-default">+</button> <button ng-show="player2CanMoins(match)" ng-click="player2Moins(match)" type="button" class="score-moins btn btn-default">-</button> </div> </div> <div class="scores"> <div class="set"> <div class="points">{{match.set1Player1}} </div> <div class="points">{{match.set1Player2}} </div> </div> <div ng-show="match.set1Finished == true" class="set"> <div class="points">{{match.set2Player1}} </div> <div class="points">{{match.set2Player2}} </div> </div> <div ng-show="match.set2Finished == true" class="set"> <div class="points">{{match.set3Player1}} </div> <div class="points">{{match.set3Player2}} </div> </div> </div> <div class="button-delete"> <button ng-click="deleteMatchLive(match.idMatchLive)" type="button" class="btn btn-default btn-save"><span class="glyphicon glyphicon-remove"></span></button> </div> <div class="separator"></div> </div> </div> </div>')}]);